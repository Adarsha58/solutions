Easy to do an exhaustive search. Probably not necessary, but I added memoisation of results, as there may be a lot of repeat lookups.
