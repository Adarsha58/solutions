A strings / dynamic programming problem. 
